
# ì„œë¸”ë¦¿ ì˜ˆì™¸ ì²˜ë¦¬ - ì˜¤ë¥˜ í˜ì´ì§€ ì‘ë™ ì›ë¦¬

### ì˜ˆì™¸ ë°œìƒ â¡ï¸ ì˜¤ë¥˜ í˜ì´ì§€ flow

ì„œë¸”ë¦¿ì€ Exception (ì˜ˆì™¸)ê°€ ë°œìƒí•´ì„œ ì„œë¸”ë¦¿ ë°–ìœ¼ë¡œ ì „ë‹¬ë˜ê±°ë‚˜ ë˜ëŠ” response.sendError()ê°€ í˜¸ì¶œ ë˜ì—ˆ
ì„ ë•Œ ì„¤ì •ëœ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì°¾ëŠ”ë‹¤.

ì˜ˆì™¸ ë°œìƒ íë¦„
- ```WAS(ì—¬ê¸°ê¹Œì§€ ì „íŒŒ) â¬…ï¸ í•„í„° â¬…ï¸ ì„œë¸”ë¦¿ â¬…ï¸ ì¸í„°ì…‰í„° â¬…ï¸ ì»¨íŠ¸ë¡¤ëŸ¬(ì˜ˆì™¸ë°œìƒ)```

sendError íë¦„
- ```WAS(sendError í˜¸ì¶œ ê¸°ë¡ í™•ì¸) â¬…ï¸ í•„í„° â¬…ï¸ ì„œë¸”ë¦¿ â¬…ï¸ ì¸í„°ì…‰í„°â¬…ï¸ ì»¨íŠ¸ë¡¤ëŸ¬(response.sendError())```

WASëŠ” í•´ë‹¹ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì˜¤ë¥˜ í˜ì´ì§€ ì •ë³´ë¥¼ í™•ì¸í•œë‹¤.
- ```new ErrorPage(RuntimeException.class, "/error-page/500")```

ì˜ˆë¥¼ ë“¤ì–´ì„œ RuntimeException ì˜ˆì™¸ê°€ WASê¹Œì§€ ì „ë‹¬ë˜ë©´, WASëŠ” ì˜¤ë¥˜ í˜ì´ì§€ ì •ë³´ë¥¼ í™•ì¸í•œë‹¤.
í™•ì¸í•´ë³´ë‹ˆ RuntimeException ì˜ ì˜¤ë¥˜ í˜ì´ì§€ë¡œ /error-page/500 ì´ ì§€ì •ë˜ì–´ ìˆë‹¤.
WASëŠ” ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì¶œë ¥í•˜ê¸° ìœ„í•´ /error-page/500 ë¥¼ ë‹¤ì‹œ ìš”ì²­í•œë‹¤.

ì˜¤ë¥˜ í˜ì´ì§€ ìš”ì²­ íë¦„
- ```WAS /error-page/500 ë‹¤ì‹œ ìš”ì²­ â¡ï¸ í•„í„° â¡ï¸ ì„œë¸”ë¦¿ â¡ï¸ ì¸í„°ì…‰í„° â¡ï¸ ì»¨íŠ¸ë¡¤ëŸ¬(/error-page/500)-> View```

ì˜ˆì™¸ ë°œìƒê³¼ ì˜¤ë¥˜ í˜ì´ì§€ ìš”ì²­ íë¦„
````text
1. WAS(ì—¬ê¸°ê¹Œì§€ ì „íŒŒ) â¬…ï¸ í•„í„° â¬…ï¸ ì„œë¸”ë¦¿ â¬…ï¸ ì¸í„°ì…‰í„° â¬…ï¸ ì»¨íŠ¸ë¡¤ëŸ¬(ì˜ˆì™¸ë°œìƒ)
2. WAS /error-page/500 ë‹¤ì‹œ ìš”ì²­ â¡ï¸ í•„í„° â¡ï¸ ì„œë¸”ë¦¿ â¡ï¸ ì¸í„°ì…‰í„° â¡ï¸ ì»¨íŠ¸ë¡¤ëŸ¬(/error-page/500) -> View
````

ì¤‘ìš”í•œ ì ì€ ì›¹ ë¸Œë¼ìš°ì €(í´ë¼ì´ì–¸íŠ¸)ëŠ” ì„œë²„ ë‚´ë¶€ì—ì„œ ì´ëŸ° ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ì „í˜€ ëª¨ë¥¸ë‹¤ëŠ” ì ì´ë‹¤.
ì˜¤ì§ ì„œë²„ ë‚´ë¶€ì—ì„œ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ì°¾ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ í˜¸ì¶œì„ í•œë‹¤.

ğŸ’¯ì •ë¦¬
- ì˜ˆì™¸ê°€ ë°œìƒí•´ì„œ WASê¹Œì§€ ì „íŒŒëœë‹¤.
- WASëŠ” ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œë¥¼ ì°¾ì•„ì„œ ë‚´ë¶€ì—ì„œ ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ í˜¸ì¶œí•œë‹¤.
  - ì´ë•Œ ì˜¤ë¥˜ í˜ì´ì§€ ê²½ë¡œë¡œ í•„í„°, ì„œë¸”ë¦¿, ì¸í„°ì…‰í„°, ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ëª¨ë‘ ë‹¤ì‹œ í˜¸ì¶œëœë‹¤.

### ì˜¤ë¥˜ ì •ë³´ ì¶”ê°€

- WASëŠ” ì˜¤ë¥˜ í˜ì´ì§€ë¥¼ ë‹¨ìˆœíˆ ë‹¤ì‹œ ìš”ì²­ë§Œ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì˜¤ë¥˜ ì •ë³´ë¥¼ request ì˜ attribute ì— ì¶”ê°€í•´ì„œ ë„˜ê²¨ì¤€ë‹¤.
- í•„ìš”í•˜ë©´ ì˜¤ë¥˜ í˜ì´ì§€ì—ì„œ ì´ë ‡ê²Œ ì „ë‹¬ëœ ì˜¤ë¥˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```java
@Slf4j
@Controller
public class ErrorPageController {

     //RequestDispatcher ìƒìˆ˜ë¡œ ì •ì˜ë˜ì–´ ìˆìŒ
     public static final String ERROR_EXCEPTION = "jakarta.servlet.error.exception";
     public static final String ERROR_EXCEPTION_TYPE = "jakarta.servlet.error.exception_type";
     public static final String ERROR_MESSAGE = "jakarta.servlet.error.message";
     public static final String ERROR_REQUEST_URI = "jakarta.servlet.error.request_uri";
     public static final String ERROR_SERVLET_NAME = "jakarta.servlet.error.servlet_name";
     public static final String ERROR_STATUS_CODE = "jakarta.servlet.error.status_code";

    @RequestMapping("/error-page/404")
    public String errorPage404(HttpServletRequest request, HttpServletResponse response){
        log.info("errorPage 404");
        printErrorInfo(request);
        return "error-page/404";
    }

    @RequestMapping("/error-page/500")
    public String errorPage500(HttpServletRequest request, HttpServletResponse response){
        log.info("errorPage 500");
        printErrorInfo(request);
        return "error-page/500";
    }

    private void printErrorInfo(HttpServletRequest request) {
         //exì˜ ê²½ìš° NestedServletException ìŠ¤í”„ë§ì´ í•œë²ˆ ê°ì‹¸ì„œ ë°˜í™˜
         log.info("ERROR_EXCEPTION: ex=", request.getAttribute(ERROR_EXCEPTION));
         log.info("ERROR_EXCEPTION_TYPE: {}", request.getAttribute(ERROR_EXCEPTION_TYPE));
         log.info("ERROR_MESSAGE: {}", request.getAttribute(ERROR_MESSAGE));
         log.info("ERROR_REQUEST_URI: {}", request.getAttribute(ERROR_REQUEST_URI));
         log.info("ERROR_SERVLET_NAME: {}", request.getAttribute(ERROR_SERVLET_NAME));
         log.info("ERROR_STATUS_CODE: {}", request.getAttribute(ERROR_STATUS_CODE));
         log.info("dispatchType={}", request.getDispatcherType());
    }
}
```
request.attributeì— ì„œë²„ê°€ ë‹´ì•„ì¤€ ì •ë³´ (javax â¡ï¸ jakarta )
- javax.servlet.error.exception : ì˜ˆì™¸
- javax.servlet.error.exception_type : ì˜ˆì™¸ íƒ€ì…
- javax.servlet.error.message : ì˜¤ë¥˜ ë©”ì‹œì§€
- javax.servlet.error.request_uri : í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ URI
- javax.servlet.error.servlet_name : ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì„œë¸”ë¦¿ ì´ë¦„
- javax.servlet.error.status_code : HTTP ìƒíƒœ ì½”ë“œ



