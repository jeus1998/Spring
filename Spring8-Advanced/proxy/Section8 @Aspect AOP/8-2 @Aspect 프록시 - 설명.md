# @Aspect 프록시 - 설명

### 자동 프록시 생성기 - AnnotationAwareAspectJAutoProxyCreator

- 앞에서 자동 프록시 생성기(AnnotationAwareAspectJAutoProxyCreator)는 ``Advisor``를 자동으로 찾아와서 필요한 곳에 
  프록시를 생성하고 적용해준다고 했다.
- 자동 프록시 생성기는 여기에 추가로 하나의 역할을 더 하는데, 바로 ```@Aspect```를 찾아서 이것을 ``Advisor``로 만들어준다.
- 즉 ```@Aspect```를 ``Advisor``로 변환해서 저장하는 기능도 한다.

![1.png](Image%2F1.png)

자동 프록시 생성기는 2가지 일을 한다.
1. ```@Aspect```를 보고 어드바이저(Advisor)로 변환해서 저장한다
2. 어드바이저를 기반으로 프록시를 생성한다.

```@Aspect```를 어드바이저로 변환해서 저장하는 과정
![2.png](Image%2F2.png)
1. 스프링 애플리케이션 로딩 시점에 자동 프록시 생성기를 호출한다.
2. 모든 ```@Aspect```빈 조회: 자동 프록시 생성기는 스프링 컨테이너에서 ```@Aspect```애노테이션이 붙은 스프링 빈을 모두 조회한다.
3. 어드바이저 생성: ```@Aspect``` 어드바이저 빌더를 통해 ```@Aspect```애노테이션 정보를 기반으로 어드바이저를 생성한다.
4. ```@Aspect```기반 어드바이저 저장: 생성한 어드바이저를 ```@Aspect```어드바이저 빌더 내부에 저장한다.

```@Aspect```어드바이저 빌더
```text
BeanFactoryAspectJAdvisorsBuilder 클래스이다.
@Aspect 의 정보를 기반으로 포인트컷, 어드바이스, 어드바이저를 생성하고 보관하는 것을 담당한다.
@Aspect 의 정보를 기반으로 어드바이저를 만들고, @Aspect 어드바이저 빌더 내부 저장소에 캐시한다. 
캐시에 어드바이저가 이미 만들어져 있는 경우 캐시에 저장된 어드바이저를 반환한다.
```

어드바이저를 기반으로 프록시 생성
![3.png](Image%2F3.png)
